# Release Instructions for coaws

This document explains how to create and publish releases for the coaws CLI tool.

## Prerequisites

1. **Install GoReleaser**:
   ```bash
   # macOS/Linux
   brew install goreleaser
   
   # Or download from https://goreleaser.com/install/
   ```

2. **GitHub Token**: Ensure you have a GitHub personal access token with `repo` permissions set as `GITHUB_TOKEN` environment variable.

## Creating a Release

### 1. Test the Build Locally (Snapshot)

Before creating a real release, test that everything builds correctly:

```bash
cd /home/jhenriquez/repos/aws-cost-optimization-tools
goreleaser release --snapshot --clean
```

This will:
- Build binaries for all platforms (Linux, macOS, Windows)
- Create archives (.tar.gz, .zip)
- Generate checksums
- Create .deb and .rpm packages
- **NOT publish** anything (snapshot mode)

Check the `dist/` directory for the generated artifacts.

### 2. Create a Git Tag

```bash
# Ensure you're on main branch and up to date
git checkout main
git pull origin main

# Create and push a version tag
git tag -a v1.0.0 -m "Release version 1.0.0"
git push origin v1.0.0
```

### 3. Automated Release via GitHub Actions

Once you push a tag, GitHub Actions will automatically:
1. Run tests
2. Build binaries for all platforms
3. Create a GitHub Release
4. Upload all artifacts
5. Generate changelog

You can monitor the progress at:
```
https://github.com/Th3Mayar/aws-cost-optimization-tools/actions
```

### 4. Manual Release (Alternative)

If you prefer to release manually:

```bash
# Set your GitHub token
export GITHUB_TOKEN="your_github_token_here"

# Create a tag
git tag -a v1.0.0 -m "Release version 1.0.0"

# Run GoReleaser
goreleaser release --clean
```

## Version Numbering

Follow [Semantic Versioning](https://semver.org/):
- **MAJOR** version (v2.0.0): Incompatible API changes
- **MINOR** version (v1.1.0): New functionality, backwards compatible
- **PATCH** version (v1.0.1): Bug fixes, backwards compatible

Examples:
```bash
git tag -a v1.0.0 -m "Initial release"
git tag -a v1.1.0 -m "Add new tagging mode"
git tag -a v1.0.1 -m "Fix installation script bug"
```

## Post-Release Checklist

After a release is published:

1. ✅ Verify the release on GitHub: `https://github.com/Th3Mayar/aws-cost-optimization-tools/releases`
2. ✅ Test installation scripts:
   ```bash
   # Linux/macOS
   curl -sSL https://raw.githubusercontent.com/Th3Mayar/aws-cost-optimization-tools/main/install.sh | bash
   
   # Windows (PowerShell)
   irm https://raw.githubusercontent.com/Th3Mayar/aws-cost-optimization-tools/main/install.ps1 | iex
   ```
3. ✅ Test binary downloads work for all platforms
4. ✅ Update documentation if needed
5. ✅ Announce the release (Twitter, blog, etc.)

## Troubleshooting

### Build fails during release

```bash
# Test locally first
goreleaser release --snapshot --clean

# Check logs in GitHub Actions
# Fix any errors and create a new tag
```

### Installation script doesn't work

```bash
# Test the script locally
./install.sh

# Check that the URL pattern matches in .goreleaser.yml
```

## Distribution Channels

After release, binaries are available via:

1. **Direct download**: GitHub Releases page
2. **Install script**: `curl | bash` (Linux/macOS) or `irm | iex` (Windows)
3. **Package managers**: 
   - APT (.deb packages)
   - YUM/DNF (.rpm packages)
   - APK (.apk packages for Alpine)
4. **Homebrew** (optional, requires separate tap repository)

## Files Generated

Each release creates:
- Binary executables for each OS/architecture
- Compressed archives (.tar.gz for Unix, .zip for Windows)
- Checksums file (checksums.txt)
- Linux packages (.deb, .rpm, .apk)
- Source code archives (auto-generated by GitHub)
